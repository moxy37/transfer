SELECT CONCAT('https://www.edge-ai-vision.com/', YEAR(post_date), '/', MONTH(post_date), '/', post_name) AS link, (length(post_content )-length(replace(post_content ,'http://embedded-vision.com','')))/19+1 AS count FROM wp_posts WHERE ID IN (SELECT CASE WHEN post_parent=0 THEN ID ELSE post_parent END FROM wp_posts WHERE post_content LIKE '%http://embedded-vision.com%') AND post_status='publish';